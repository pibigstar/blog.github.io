<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="派大星, pibigstar,blog,go">










<meta name="keywords" content="派大星,pibigstar">
<meta property="og:type" content="website">
<meta property="og:title" content="派大星的博客">
<meta property="og:url" content="http://pibigstar.com/page/6/index.html">
<meta property="og:site_name" content="派大星的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="派大星的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pibigstar.com/page/6/">





  <title>派大星的博客 - 很多事情不是会了才能做，而是做了才能学会</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">派大星的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">很多事情不是会了才能做，而是做了才能学会</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/22/SpringBoot整合Druid和MyBatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/22/SpringBoot整合Druid和MyBatis/" itemprop="url">SpringBoot整合Druid和MyBatis</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-22T14:02:04+08:00">
                2019-06-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot-mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">springboot,mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-加入依赖"><a href="#1-加入依赖" class="headerlink" title="1. 加入依赖"></a>1. 加入依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- druid --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mybatis对接Spring --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mysql链接驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jdbc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="2-application-yml中添加配置"><a href="#2-application-yml中添加配置" class="headerlink" title="2. application.yml中添加配置"></a>2. application.yml中添加配置</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    druid:</span></span><br><span class="line"><span class="attr">    datasource:</span></span><br><span class="line"><span class="attr">      type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="attr">      driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">      initialSize:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">      minIdle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">      maxActive:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">      maxWait:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">      timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">      minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">      validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">      testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      testOnBorrow:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      testOnReturn:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">      filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line"><span class="attr">      connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</span></span><br><span class="line"><span class="attr">      useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      loginUsername:</span> <span class="string">pibigstar</span></span><br><span class="line"><span class="attr">      loginPassword:</span> <span class="string">pibigstar</span></span><br><span class="line">      <span class="comment">#数据库连接地址</span></span><br><span class="line"><span class="attr">      url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;allowMultiQueries=true&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Shanghai&amp;useSSL=false</span></span><br><span class="line">      <span class="comment">#用户名</span></span><br><span class="line"><span class="attr">      username:</span> <span class="string">root</span></span><br><span class="line">      <span class="comment">#密码</span></span><br><span class="line"><span class="attr">      password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>

<h1 id="3-配置映射类"><a href="#3-配置映射类" class="headerlink" title="3. 配置映射类"></a>3. 配置映射类</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.druid.datasource"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="keyword">private</span> String driverClassName;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer initialSize;</span><br><span class="line">    <span class="keyword">private</span> Integer minIdle;</span><br><span class="line">    <span class="keyword">private</span> Integer maxActive;</span><br><span class="line">    <span class="keyword">private</span> Long maxWait;</span><br><span class="line">    <span class="keyword">private</span> Long timeBetweenEvictionRunsMillis;</span><br><span class="line">    <span class="keyword">private</span> Long minEvictableIdleTimeMillis;</span><br><span class="line">    <span class="keyword">private</span> String validationQuery;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testWhileIdle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnBorrow;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> testOnReturn;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> poolPreparedStatements;</span><br><span class="line">    <span class="keyword">private</span> Integer maxPoolPreparedStatementPerConnectionSize;</span><br><span class="line">    <span class="keyword">private</span> String filters;</span><br><span class="line">    <span class="keyword">private</span> String connectionProperties;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> useGlobalDataSourceStat;</span><br><span class="line">    <span class="keyword">private</span> String loginUsername;</span><br><span class="line">    <span class="keyword">private</span> String loginPassword;</span><br><span class="line">    <span class="comment">//setter,getter方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-初始化Druid"><a href="#4-初始化Druid" class="headerlink" title="4. 初始化Druid"></a>4. 初始化Druid</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DruidProperties properties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">dataSource</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        dataSource.setDriverClassName(properties.getDriverClassName());</span><br><span class="line">        dataSource.setUrl(properties.getUrl());</span><br><span class="line">        dataSource.setUsername(properties.getUsername());</span><br><span class="line">        dataSource.setPassword(properties.getPassword());</span><br><span class="line">        dataSource.setInitialSize(properties.getInitialSize());</span><br><span class="line">        dataSource.setMinIdle(properties.getMinIdle());</span><br><span class="line">        dataSource.setMaxActive(properties.getMaxActive());</span><br><span class="line">        dataSource.setMaxWait(properties.getMaxWait());</span><br><span class="line">        dataSource.setTimeBetweenEvictionRunsMillis(properties.getTimeBetweenEvictionRunsMillis());</span><br><span class="line">        dataSource.setMinEvictableIdleTimeMillis(properties.getMinEvictableIdleTimeMillis());</span><br><span class="line">        String validationQuery = properties.getValidationQuery();</span><br><span class="line">        <span class="keyword">if</span> (validationQuery != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(validationQuery)) &#123;</span><br><span class="line">            dataSource.setValidationQuery(validationQuery);</span><br><span class="line">        &#125;</span><br><span class="line">        dataSource.setTestWhileIdle(properties.isTestWhileIdle());</span><br><span class="line">        dataSource.setTestOnBorrow(properties.isTestOnBorrow());</span><br><span class="line">        dataSource.setTestOnReturn(properties.isTestOnReturn());</span><br><span class="line">        <span class="keyword">if</span> (properties.isPoolPreparedStatements()) &#123;</span><br><span class="line">            dataSource.setMaxPoolPreparedStatementPerConnectionSize(properties.getMaxPoolPreparedStatementPerConnectionSize());</span><br><span class="line">        &#125;</span><br><span class="line">        String connectionPropertiesStr = properties.getConnectionProperties();</span><br><span class="line">        <span class="keyword">if</span> (connectionPropertiesStr != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(connectionPropertiesStr)) &#123;</span><br><span class="line">            Properties connectProperties = <span class="keyword">new</span> Properties();</span><br><span class="line">            String[] propertiesList = connectionPropertiesStr.split(<span class="string">";"</span>);</span><br><span class="line">            <span class="keyword">for</span> (String propertiesTmp : propertiesList) &#123;</span><br><span class="line">                String[] obj = propertiesTmp.split(<span class="string">"="</span>);</span><br><span class="line">                String key = obj[<span class="number">0</span>];</span><br><span class="line">                String value = obj[<span class="number">1</span>];</span><br><span class="line">                connectProperties.put(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">            dataSource.setConnectProperties(connectProperties);</span><br><span class="line">        &#125;</span><br><span class="line">        dataSource.setUseGlobalDataSourceStat(properties.isUseGlobalDataSourceStat());</span><br><span class="line">        WallConfig wallConfig = <span class="keyword">new</span> WallConfig();</span><br><span class="line">        wallConfig.setMultiStatementAllow(<span class="keyword">true</span>);</span><br><span class="line">        WallFilter wallFilter = <span class="keyword">new</span> WallFilter();</span><br><span class="line">        wallFilter.setConfig(wallConfig);</span><br><span class="line">        List&lt;Filter&gt; filters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        filters.add(wallFilter);</span><br><span class="line">        filters.add(<span class="keyword">new</span> StatFilter());</span><br><span class="line">        filters.add(<span class="keyword">new</span> Log4jFilter());</span><br><span class="line">        dataSource.setProxyFilters(filters);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Druid的Servlet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">druidStatViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ServletRegistrationBean servletRegistrationBean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet(), <span class="string">"/druid/*"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** 添加初始化参数：initParams */</span></span><br><span class="line">        <span class="comment">/** 白名单，如果不配置或value为空，则允许所有 */</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">"allow"</span>, <span class="string">"127.0.0.1,192.0.0.1"</span>);</span><br><span class="line">        <span class="comment">/** 黑名单，与白名单存在相同IP时，优先于白名单 */</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">"deny"</span>, <span class="string">"192.0.0.1"</span>);</span><br><span class="line">        <span class="comment">/** 用户名 */</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">"loginUsername"</span>, properties.getLoginUsername());</span><br><span class="line">        <span class="comment">/** 密码 */</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">"loginPassword"</span>, properties.getLoginPassword());</span><br><span class="line">        <span class="comment">/** 禁用页面上的“Reset All”功能 */</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">"resetEnable"</span>, <span class="string">"false"</span>);</span><br><span class="line">        <span class="keyword">return</span> servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Druid拦截器，用于查看Druid监控</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">druidStatFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        FilterRegistrationBean filterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">        <span class="comment">/** 过滤规则 */</span></span><br><span class="line">        filterRegistrationBean.addUrlPatterns(<span class="string">"/*"</span>);</span><br><span class="line">        <span class="comment">/** 忽略资源 */</span></span><br><span class="line">        filterRegistrationBean.addInitParameter(<span class="string">"exclusions"</span>, <span class="string">"*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"</span>);</span><br><span class="line">        <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-Druid与Mybatis对接"><a href="#5-Druid与Mybatis对接" class="headerlink" title="5. Druid与Mybatis对接"></a>5. Druid与Mybatis对接</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter</span>(DruidAutoConfiguration.class)</span><br><span class="line"><span class="meta">@MapperScan</span>(value = &#123;<span class="string">"com.pibigstar.**.mapper.**"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisAutoConfiguration</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * mybatis 配置路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String MYBATIS_CONFIG = <span class="string">"classpath:mybatis/mybatis-config.xml"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * mybatis mapper xml</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] MAPPER_LOCATIONS_CONFIG = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">            <span class="string">"classpath*:com/pibigstar/**/mapper/mysql/*.xml"</span>,</span><br><span class="line">            <span class="string">"classpath*:com/pibigstar/**/mapper/mysql/*/*.xml"</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DruidDataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建sqlSession</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"sqlSessionFactory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactoryBean <span class="title">createSqlSessionFactoryBean</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        PathMatchingResourcePatternResolver resolver = <span class="keyword">new</span> PathMatchingResourcePatternResolver();</span><br><span class="line">        Resource resource = resolver.getResource(MYBATIS_CONFIG);</span><br><span class="line"></span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** 设置mybatis configuration 扫描路径 */</span></span><br><span class="line">        sqlSessionFactoryBean.setConfigLocation(resource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** 设置datasource */</span></span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** 设置mapperLocations */</span></span><br><span class="line">        List&lt;Resource&gt; all = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String mapperLocation : MAPPER_LOCATIONS_CONFIG) &#123;</span><br><span class="line">            all.addAll(Arrays.asList(resolver.getResources(mapperLocation)));</span><br><span class="line">        &#125;</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(all.toArray(<span class="keyword">new</span> Resource[all.size()]));</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionTemplate <span class="title">sqlSessionTemplate</span><span class="params">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置事务管理器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"transactionManager"</span>)</span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceTransactionManager <span class="title">transactionManager</span><span class="params">(@Qualifier(<span class="string">"dataSource"</span>)</span> DataSource dataSource) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-新建mybatis-config-xml文件"><a href="#6-新建mybatis-config-xml文件" class="headerlink" title="6. 新建mybatis-config.xml文件"></a>6. 新建mybatis-config.xml文件</h1><p>在resources下新建mybatis文件夹，在此文件夹下新建<code>mybatis-config.xml</code>文件<br>可以在此文件中新增mysql插件之类的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"callSettersOnNulls"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"localCacheScope"</span> <span class="attr">value</span>=<span class="string">"STATEMENT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logPrefix"</span> <span class="attr">value</span>=<span class="string">"dao."</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="7-新建log4j-properties"><a href="#7-新建log4j-properties" class="headerlink" title="7. 新建log4j.properties"></a>7. 新建log4j.properties</h1><p>在resources下新建<code>log4j.properties</code>文件，如果没有此文件，控制台不会输出SQL语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#1. DEBUG</span><br><span class="line">#2. INFO</span><br><span class="line">#3. WARN</span><br><span class="line">#4. ERROR</span><br><span class="line">#5. FATAL</span><br><span class="line">log4j.rootLogger=DEBUG,stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d [%p] %c:%L - %m%n</span><br></pre></td></tr></table></figure>

<h1 id="8-测试"><a href="#8-测试" class="headerlink" title="8. 测试"></a>8. 测试</h1><p>启动项目，浏览器访问：<a href="http://localhost:8080/druid/index.html" target="_blank" rel="noopener">http://localhost:8080/druid/index.html</a><br>会自动跳转到登录页面，输入你在application.yml文件中配置的loginUsername和loginPassword，可进入首页，首页如下：<br><img src="https://img-blog.csdnimg.cn/20190411164151262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt><br>控制台打印SQL信息<br><img src="https://img-blog.csdnimg.cn/20190411170612307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/20/Centos安装可视化桌面（noVNC）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/Centos安装可视化桌面（noVNC）/" itemprop="url">Centos安装可视化桌面（noVNC）</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T15:03:04+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>@[toc]</p>
<h1 id="1-关闭防火墙"><a href="#1-关闭防火墙" class="headerlink" title="1. 关闭防火墙"></a>1. 关闭防火墙</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>

<h1 id="2-安装tigervnc"><a href="#2-安装tigervnc" class="headerlink" title="2. 安装tigervnc"></a>2. 安装tigervnc</h1><h2 id="2-1-锁定配置"><a href="#2-1-锁定配置" class="headerlink" title="2.1 锁定配置"></a>2.1 锁定配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chattr +i /etc/resolv.conf</span><br></pre></td></tr></table></figure>

<h2 id="2-2-安装tigervnc"><a href="#2-2-安装tigervnc" class="headerlink" title="2.2 安装tigervnc"></a>2.2 安装tigervnc</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y tigervnc tigervnc-server</span><br></pre></td></tr></table></figure>

<h2 id="2-3-安装桌面"><a href="#2-3-安装桌面" class="headerlink" title="2.3 安装桌面"></a>2.3 安装桌面</h2><p><strong>查看支持的桌面</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum grouplist</span><br></pre></td></tr></table></figure>

<p><strong>安装桌面</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall -y <span class="string">"GNOME Desktop"</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个过程会很慢，耐心等待</p>
</blockquote>
<h2 id="2-4-安装桌面插件"><a href="#2-4-安装桌面插件" class="headerlink" title="2.4 安装桌面插件"></a>2.4 安装桌面插件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gnome-panel</span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装结束之后会报 <code>Error：Nothing to do</code>，不用管，没事</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nautilus</span><br></pre></td></tr></table></figure>

<h2 id="2-5-更换显示模式"><a href="#2-5-更换显示模式" class="headerlink" title="2.5 更换显示模式"></a>2.5 更换显示模式</h2><blockquote>
<p>默认是图形界面的模式，你可以修改为命令行模式</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置成命令模式</span></span><br><span class="line">systemctl <span class="built_in">set</span>-default multi-user.target  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置成图形模式</span></span><br><span class="line">systemctl <span class="built_in">set</span>-default graphical.target</span><br></pre></td></tr></table></figure>

<h1 id="3-配置tigervnc"><a href="#3-配置tigervnc" class="headerlink" title="3. 配置tigervnc"></a>3. 配置tigervnc</h1><h2 id="3-1-设置密码"><a href="#3-1-设置密码" class="headerlink" title="3.1 设置密码"></a>3.1 设置密码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vncpasswd</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190918223222168.png" alt></p>
<h2 id="3-2-启动vnc"><a href="#3-2-启动vnc" class="headerlink" title="3.2 启动vnc"></a>3.2 启动vnc</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vncserver :1</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>:</code> 后面是端口号，0-99  不指定默认为1，第一次会提示输入密码，前两次是可读可写的密码，输入y之后，输入只读的密码，当用只读密码进来时，只能看不能操作，以后可以使用<code>vncpasswd</code>命令修改密码。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20190918223321627.png" alt></p>
<h1 id="4-登录vnc"><a href="#4-登录vnc" class="headerlink" title="4. 登录vnc"></a>4. 登录vnc</h1><h2 id="4-1-下载VNC-Viewer"><a href="#4-1-下载VNC-Viewer" class="headerlink" title="4.1 下载VNC Viewer"></a>4.1 下载VNC Viewer</h2><p>下载地址：<a href="https://www.realvnc.com/en/connect/download/viewer/windows/" target="_blank" rel="noopener">https://www.realvnc.com/en/connect/download/viewer/windows/</a></p>
<h2 id="4-2-登录"><a href="#4-2-登录" class="headerlink" title="4.2 登录"></a>4.2 登录</h2><p><img src="https://img-blog.csdnimg.cn/20190918223500217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size%E9%A2%9D_16,color_FFFFFF,t_70" alt></p>
<blockquote>
<p><code>VNC Server</code> 为 <code>你的IP:1</code>  这个1 是我们前面启动<code>vncserver</code>后面的1，如果你写的2，这里也要写2</p>
</blockquote>
<h2 id="4-3-登录效果"><a href="#4-3-登录效果" class="headerlink" title="4.3 登录效果"></a>4.3 登录效果</h2><p><img src="https://img-blog.csdnimg.cn/20190918223710404.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h1 id="5-安装noVnc"><a href="#5-安装noVnc" class="headerlink" title="5. 安装noVnc"></a>5. 安装noVnc</h1><h2 id="5-1-下载"><a href="#5-1-下载" class="headerlink" title="5.1 下载"></a>5.1 下载</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载</span></span><br><span class="line">wget https://github.com/novnc/noVNC/archive/master.zip</span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">unzip master.zip</span><br></pre></td></tr></table></figure>

<h2 id="5-2-生成证书"><a href="#5-2-生成证书" class="headerlink" title="5.2 生成证书"></a>5.2 生成证书</h2><blockquote>
<p>证书要放到<code>utils</code>文件夹下面</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> noVNC-master/utils</span><br><span class="line"><span class="comment"># 生成证书</span></span><br><span class="line">openssl req -new -x509 -days 365 -nodes -out self.pem -keyout self.pem</span><br></pre></td></tr></table></figure>

<blockquote>
<p>前面都不用写，只需要填写<code>Common Name (e.g. server FQDN or YOUR name) []:</code>这个字段，填写的内容是本机的<code>hostname</code>，可通过下面命令查看本机的hostname</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure>

<h2 id="5-3-安装noVnc"><a href="#5-3-安装noVnc" class="headerlink" title="5.3 安装noVnc"></a>5.3 安装noVnc</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">./utils/launch.sh --vnc localhost:5901</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20190918113718735.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt><br>浏览器打开：<code>http://你的IP:6080/vnc.html</code> 即可看到效果<br><img src="https://img-blog.csdnimg.cn/20190918224132159.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt><br>输入我们前面设置的密码，即可进入桌面<br><img src="https://img-blog.csdnimg.cn/2019091822420146.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/18/Java使用itexpdf创建pdf文件并添加水印/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/18/Java使用itexpdf创建pdf文件并添加水印/" itemprop="url">Java使用itexpdf创建pdf文件并添加水印</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-18T16:04:04+08:00">
                2019-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java-java工具类-SpringBoot技能大全/" itemprop="url" rel="index">
                    <span itemprop="name">Java,java工具类,SpringBoot技能大全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itextpdf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-java代码"><a href="#2-java代码" class="headerlink" title="2. java代码"></a>2. java代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.itextpdf.text.Image;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.PdfContentByte;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.PdfGState;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.PdfReader;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.PdfStamper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> pibigstar</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2018-11-30 13:30</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> pdf工具类</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PDFUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> IAMGE_HEIGHT = <span class="number">110f</span>; <span class="comment">// 水印图片的的高度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> IAMGE_WIDTH = <span class="number">110f</span>; <span class="comment">// 水印图片的的宽度</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 创建pdf文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filePath: 输出文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> contents：文件内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createPdf</span><span class="params">(String filePath,String contents)</span> </span>&#123;</span><br><span class="line">        Document document = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            document = <span class="keyword">new</span> Document(PageSize.A4);</span><br><span class="line">            PdfWriter.getInstance(document,<span class="keyword">new</span> FileOutputStream(filePath));</span><br><span class="line">            document.open();</span><br><span class="line">            <span class="comment">//添加创建时间</span></span><br><span class="line">            document.addCreationDate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//使用Windows系统字体（解决中文显示问题）</span></span><br><span class="line">            BaseFont baseFont = BaseFont.createFont(<span class="string">"C:/Windows/Fonts/SIMYOU.TTF"</span>,BaseFont.IDENTITY_H,BaseFont.NOT_EMBEDDED);</span><br><span class="line">            Font font = <span class="keyword">new</span> Font(baseFont);</span><br><span class="line">            <span class="comment">// 设置一段内容</span></span><br><span class="line">            Paragraph paragraph = <span class="keyword">new</span> Paragraph(contents,font);</span><br><span class="line">            <span class="comment">//设置居中对齐</span></span><br><span class="line">            paragraph.setAlignment(Element.ALIGN_CENTER);</span><br><span class="line"></span><br><span class="line">            document.add(paragraph);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (document!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                document.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 添加Pdf水印</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pdfPath pdf地址</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> logoPath 水印图片地址</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outPath 输出pdf地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addPdfMark</span><span class="params">(String pdfPath,String logoPath, String outPath)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        PdfReader reader = <span class="keyword">new</span> PdfReader(pdfPath, <span class="string">"PDF"</span>.getBytes());</span><br><span class="line">        <span class="comment">// 如果是web项目，直接下载应该放到response的流里面</span></span><br><span class="line">        <span class="comment">// PdfStamper stamp = new PdfStamper(reader,response.getOutputStream());</span></span><br><span class="line">        <span class="comment">// 添加水印之后的pdf文件</span></span><br><span class="line">        PdfStamper stamp = <span class="keyword">new</span> PdfStamper(reader, <span class="keyword">new</span> FileOutputStream(outPath));</span><br><span class="line">        <span class="keyword">int</span> pageSize = reader.getNumberOfPages();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> pageHeight = reader.getPageSize(<span class="number">1</span>).getHeight();</span><br><span class="line">        <span class="keyword">float</span> pageWidth = reader.getPageSize(<span class="number">1</span>).getWidth();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 每两行显示两个 左边一个，右边一个</span></span><br><span class="line">            <span class="keyword">int</span> lineNum = (<span class="keyword">int</span>) (pageHeight / IAMGE_HEIGHT); <span class="comment">// 行数</span></span><br><span class="line">            <span class="keyword">int</span> middleY = (<span class="keyword">int</span>) pageWidth / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pageSize; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">0</span>; j &lt; lineNum; j = j + <span class="number">4</span>, k++) &#123;</span><br><span class="line">                    Random random = <span class="keyword">new</span> Random();</span><br><span class="line">                    <span class="comment">// 放入水印</span></span><br><span class="line">                    Image img = Image.getInstance(logoPath);</span><br><span class="line">                    img.scaleAbsolute(IAMGE_WIDTH, IAMGE_HEIGHT * <span class="number">184</span> / <span class="number">455</span>);</span><br><span class="line">                    <span class="comment">// 将水印显示到最底层</span></span><br><span class="line">                    img.setAlignment(Image.UNDERLYING);</span><br><span class="line">                    <span class="keyword">int</span> trueY;</span><br><span class="line">                    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                        trueY = random.nextInt(middleY);</span><br><span class="line">                        <span class="keyword">if</span> (trueY &gt; IAMGE_WIDTH / <span class="number">2</span> &amp;&amp; trueY &lt; (middleY - IAMGE_WIDTH)) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 水印的位置</span></span><br><span class="line">                    img.setAbsolutePosition(trueY, j * IAMGE_HEIGHT + (<span class="keyword">float</span>) random.nextInt((<span class="keyword">int</span>) IAMGE_HEIGHT) - (k % <span class="number">2</span>) * <span class="number">10</span>);</span><br><span class="line">                    <span class="comment">// 旋转 角度</span></span><br><span class="line">                    img.setRotationDegrees(random.nextInt(<span class="number">360</span>));</span><br><span class="line">                    PdfContentByte under = stamp.getUnderContent(i);</span><br><span class="line"></span><br><span class="line">                    PdfGState gs = <span class="keyword">new</span> PdfGState();</span><br><span class="line">                    <span class="comment">// 设置透明度为0.5</span></span><br><span class="line">                    gs.setFillOpacity(<span class="number">0.5f</span>);</span><br><span class="line">                    under.setGState(gs);</span><br><span class="line">                    under.addImage(img);</span><br><span class="line">                    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                        trueY = random.nextInt(middleY) + middleY;</span><br><span class="line">                        <span class="keyword">if</span> (trueY &gt; middleY + IAMGE_WIDTH / <span class="number">2</span> &amp;&amp; trueY &lt; (<span class="number">2</span> * middleY - IAMGE_WIDTH)) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 水印的位置</span></span><br><span class="line">                    img.setAbsolutePosition(trueY, j * IAMGE_HEIGHT + (<span class="keyword">float</span>) random.nextInt((<span class="keyword">int</span>) IAMGE_HEIGHT) - (k % <span class="number">2</span>) * <span class="number">10</span>);</span><br><span class="line">                    <span class="comment">// 旋转角度</span></span><br><span class="line">                    img.setRotationDegrees(random.nextInt(<span class="number">360</span>));</span><br><span class="line">                    under.addImage(img);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            stamp.close();</span><br><span class="line">            reader.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-测试"><a href="#3-测试" class="headerlink" title="3. 测试"></a>3. 测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPDFUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PDFUtil.createPdf(<span class="string">"D:\\1.pdf"</span>,<span class="string">"我是派大星"</span>);</span><br><span class="line">        PDFUtil.addPdfMark(<span class="string">"D:\\1.pdf"</span>,<span class="string">"D:\\go_logo.png"</span>,<span class="string">"D:\\test.pdf"</span>);</span><br><span class="line">        System.out.println(<span class="string">"done"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/16/java使用zxing制作二维码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/16/java使用zxing制作二维码/" itemprop="url">java使用zxing制作二维码</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-16T17:05:04+08:00">
                2019-06-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java-java工具类-SpringBoot技能大全/" itemprop="url" rel="index">
                    <span itemprop="name">Java,java工具类,SpringBoot技能大全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>因为项目需要，我封装了三个不同的二维码构建，一个是制作普通的二维码，一个是带logo的，还有一个是带logo和文字的，不废话，直接上代码。</p>
<h3 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.zxing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pibgstar.demo.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.zxing.BarcodeFormat;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.EncodeHintType;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.MultiFormatWriter;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.WriterException;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.common.BitMatrix;</span><br><span class="line"><span class="keyword">import</span> com.google.zxing.qrcode.decoder.ErrorCorrectionLevel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> pibigstar</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2018-11-29 10:17</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 二维码生成工具类</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZXingCodeUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 二维码颜色</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> QRCOLOR = <span class="number">0xFF000000</span>;</span><br><span class="line">    <span class="comment">// 背景色</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BGCOLOR = <span class="number">0xFFFFFFFF</span>;</span><br><span class="line">    <span class="comment">// 二维码宽度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> width = <span class="number">400</span>;</span><br><span class="line">    <span class="comment">// 二维码高度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> height = <span class="number">400</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:pibigstar</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 生成普通的二维码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">createCode</span><span class="params">(String qrUrl)</span> </span>&#123;</span><br><span class="line">        MultiFormatWriter multiFormatWriter = <span class="keyword">null</span>;</span><br><span class="line">        BitMatrix bm = <span class="keyword">null</span>;</span><br><span class="line">        BufferedImage image = <span class="keyword">null</span>;</span><br><span class="line">        Map&lt;EncodeHintType, Object&gt; hints = getDecodeHintType();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            multiFormatWriter = <span class="keyword">new</span> MultiFormatWriter();</span><br><span class="line">            <span class="comment">// 参数顺序分别为：编码内容，编码类型，生成图片宽度，生成图片高度，设置参数</span></span><br><span class="line">            bm = multiFormatWriter.encode(qrUrl, BarcodeFormat.QR_CODE, width, height, hints);</span><br><span class="line">            <span class="keyword">int</span> w = bm.getWidth();</span><br><span class="line">            <span class="keyword">int</span> h = bm.getHeight();</span><br><span class="line">            image = <span class="keyword">new</span> BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 开始利用二维码数据创建Bitmap图片，分别设为黑（0xFFFFFFFF）白（0xFF000000）两色</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; w; x++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; h; y++) &#123;</span><br><span class="line">                    image.setRGB(x, y, bm.get(x, y) ? QRCOLOR : BGCOLOR);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (WriterException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:pibigstar</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 生成带logo的二维码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">createCodeWithLogo</span><span class="params">(String qrUrl, String logoPath)</span> </span>&#123;</span><br><span class="line">        BufferedImage bim = createCode(qrUrl);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 读取二维码图片，并构建绘图对象</span></span><br><span class="line">            BufferedImage image = bim;</span><br><span class="line">            Graphics2D g = image.createGraphics();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读取Logo图片</span></span><br><span class="line">            BufferedImage logo = ImageIO.read(<span class="keyword">new</span> File(logoPath));</span><br><span class="line">            <span class="comment">//设置logo的大小,这里设置为二维码图片的20%,过大会盖掉二维码</span></span><br><span class="line">            <span class="keyword">int</span> widthLogo = logo.getWidth(<span class="keyword">null</span>) &gt; image.getWidth() * <span class="number">3</span> / <span class="number">10</span> ? (image.getWidth() * <span class="number">3</span> / <span class="number">10</span>) : logo.getWidth(<span class="keyword">null</span>),</span><br><span class="line">                    heightLogo = logo.getHeight(<span class="keyword">null</span>) &gt; image.getHeight() * <span class="number">3</span> / <span class="number">10</span> ? (image.getHeight() * <span class="number">3</span> / <span class="number">10</span>) : logo.getWidth(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// logo放在中心</span></span><br><span class="line">            <span class="keyword">int</span> x = (image.getWidth() - widthLogo) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> y = (image.getHeight() - heightLogo) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// logo放在右下角</span></span><br><span class="line">            <span class="comment">// int x = (image.getWidth() - widthLogo);</span></span><br><span class="line">            <span class="comment">// int y = (image.getHeight() - heightLogo);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//开始绘制图片</span></span><br><span class="line">            g.drawImage(logo, x, y, widthLogo, heightLogo, <span class="keyword">null</span>);</span><br><span class="line">            g.dispose();</span><br><span class="line">            logo.flush();</span><br><span class="line">            image.flush();</span><br><span class="line">            <span class="keyword">return</span> image;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:pibigstar</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 生成带logo和文字的二维码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title">createCodeWithLogoAndText</span><span class="params">(String qrUrl, String logoPath, String text)</span> </span>&#123;</span><br><span class="line">        BufferedImage image = createCodeWithLogo(qrUrl, logoPath);</span><br><span class="line">        <span class="comment">//把文字添加上去，文字不要太长，这里最多支持两行。太长就会自动截取啦</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (text != <span class="keyword">null</span> &amp;&amp; !text.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                <span class="comment">//新的图片，把带logo的二维码下面加上文字</span></span><br><span class="line">                BufferedImage outImage = <span class="keyword">new</span> BufferedImage(<span class="number">400</span>, <span class="number">445</span>, BufferedImage.TYPE_4BYTE_ABGR);</span><br><span class="line">                Graphics2D outg = outImage.createGraphics();</span><br><span class="line">                <span class="comment">//画二维码到新的面板</span></span><br><span class="line">                outg.drawImage(image, <span class="number">0</span>, <span class="number">0</span>, image.getWidth(), image.getHeight(), <span class="keyword">null</span>);</span><br><span class="line">                <span class="comment">//画文字到新的面板</span></span><br><span class="line">                outg.setColor(Color.BLACK);</span><br><span class="line">                outg.setFont(<span class="keyword">new</span> Font(<span class="string">"宋体"</span>, Font.BOLD, <span class="number">30</span>)); <span class="comment">//字体、字型、字号</span></span><br><span class="line">                <span class="keyword">int</span> strWidth = outg.getFontMetrics().stringWidth(text);</span><br><span class="line">                <span class="keyword">if</span> (strWidth &gt; <span class="number">399</span>) &#123;</span><br><span class="line"><span class="comment">//                  //长度过长就截取前面部分</span></span><br><span class="line"><span class="comment">//                  outg.drawString(productName, 0, image.getHeight() + (outImage.getHeight() - image.getHeight())/2 + 5 ); //画文字</span></span><br><span class="line">                    <span class="comment">//长度过长就换行</span></span><br><span class="line">                    String productName1 = text.substring(<span class="number">0</span>, text.length() / <span class="number">2</span>);</span><br><span class="line">                    String productName2 = text.substring(text.length() / <span class="number">2</span>, text.length());</span><br><span class="line">                    <span class="keyword">int</span> strWidth1 = outg.getFontMetrics().stringWidth(productName1);</span><br><span class="line">                    <span class="keyword">int</span> strWidth2 = outg.getFontMetrics().stringWidth(productName2);</span><br><span class="line">                    outg.drawString(productName1, <span class="number">200</span> - strWidth1 / <span class="number">2</span>, image.getHeight() + (outImage.getHeight() - image.getHeight()) / <span class="number">2</span> + <span class="number">12</span>);</span><br><span class="line">                    BufferedImage outImage2 = <span class="keyword">new</span> BufferedImage(<span class="number">400</span>, <span class="number">485</span>, BufferedImage.TYPE_4BYTE_ABGR);</span><br><span class="line">                    Graphics2D outg2 = outImage2.createGraphics();</span><br><span class="line">                    outg2.drawImage(outImage, <span class="number">0</span>, <span class="number">0</span>, outImage.getWidth(), outImage.getHeight(), <span class="keyword">null</span>);</span><br><span class="line">                    outg2.setColor(Color.BLACK);</span><br><span class="line">                    outg2.setFont(<span class="keyword">new</span> Font(<span class="string">"宋体"</span>, Font.BOLD, <span class="number">30</span>)); <span class="comment">//字体、字型、字号</span></span><br><span class="line">                    outg2.drawString(productName2, <span class="number">200</span> - strWidth2 / <span class="number">2</span>, outImage.getHeight() + (outImage2.getHeight() - outImage.getHeight()) / <span class="number">2</span> + <span class="number">5</span>);</span><br><span class="line">                    outg2.dispose();</span><br><span class="line">                    outImage2.flush();</span><br><span class="line">                    outImage = outImage2;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    outg.drawString(text, <span class="number">200</span> - strWidth / <span class="number">2</span>, image.getHeight() + (outImage.getHeight() - image.getHeight()) / <span class="number">2</span> + <span class="number">12</span>); <span class="comment">//画文字</span></span><br><span class="line">                &#125;</span><br><span class="line">                outg.dispose();</span><br><span class="line">                outImage.flush();</span><br><span class="line">                image = outImage;</span><br><span class="line">                image.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:pibigstar</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: 构建二维码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> BufferedImage <span class="title">create</span><span class="params">(String qrUrl, String logoPath, String text)</span> </span>&#123;</span><br><span class="line">        MultiFormatWriter multiFormatWriter = <span class="keyword">null</span>;</span><br><span class="line">        BitMatrix bm = <span class="keyword">null</span>;</span><br><span class="line">        BufferedImage image = <span class="keyword">null</span>;</span><br><span class="line">        Map&lt;EncodeHintType, Object&gt; hints = getDecodeHintType();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            multiFormatWriter = <span class="keyword">new</span> MultiFormatWriter();</span><br><span class="line">            <span class="comment">// 参数顺序分别为：编码内容，编码类型，生成图片宽度，生成图片高度，设置参数</span></span><br><span class="line">            bm = multiFormatWriter.encode(qrUrl, BarcodeFormat.QR_CODE, width, height, hints);</span><br><span class="line">            <span class="keyword">int</span> w = bm.getWidth();</span><br><span class="line">            <span class="keyword">int</span> h = bm.getHeight();</span><br><span class="line">            image = <span class="keyword">new</span> BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 开始利用二维码数据创建Bitmap图片，分别设为黑（0xFFFFFFFF）白（0xFF000000）两色</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; w; x++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; h; y++) &#123;</span><br><span class="line">                    image.setRGB(x, y, bm.get(x, y) ? QRCOLOR : BGCOLOR);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (WriterException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置二维码的格式参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;EncodeHintType, Object&gt; <span class="title">getDecodeHintType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 用于设置QR二维码参数</span></span><br><span class="line">        Map&lt;EncodeHintType, Object&gt; hints = <span class="keyword">new</span> HashMap&lt;EncodeHintType, Object&gt;();</span><br><span class="line">        <span class="comment">// 设置QR二维码的纠错级别（H为最高级别）具体级别信息</span></span><br><span class="line">        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H);</span><br><span class="line">        <span class="comment">// 设置编码方式</span></span><br><span class="line">        hints.put(EncodeHintType.CHARACTER_SET, <span class="string">"utf-8"</span>);</span><br><span class="line">        hints.put(EncodeHintType.MARGIN, <span class="number">0</span>);</span><br><span class="line">        hints.put(EncodeHintType.MAX_SIZE, <span class="number">350</span>);</span><br><span class="line">        hints.put(EncodeHintType.MIN_SIZE, <span class="number">100</span>);</span><br><span class="line">        <span class="keyword">return</span> hints;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestZxingCodeUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        BufferedImage bim = ZXingCodeUtil.createCode(<span class="string">"http://www.pibigstar.com"</span>);</span><br><span class="line">        ImageIO.write(bim, <span class="string">"png"</span>, <span class="keyword">new</span> File(<span class="string">"D:\\Document And Settings3\\Admin\\Desktop\\"</span> + <span class="keyword">new</span> Date().getTime() + <span class="string">".png"</span>));</span><br><span class="line"></span><br><span class="line">        bim = ZXingCodeUtil.createCodeWithLogo(<span class="string">"http://www.pibigstar.com"</span>,<span class="string">"D:\\Document And Settings3\\Admin\\Desktop\\文本资料\\网站\\qq.png"</span>);</span><br><span class="line">        ImageIO.write(bim, <span class="string">"png"</span>, <span class="keyword">new</span> File(<span class="string">"D:\\Document And Settings3\\Admin\\Desktop\\"</span> + <span class="keyword">new</span> Date().getTime() + <span class="string">".png"</span>));</span><br><span class="line"></span><br><span class="line">        bim = ZXingCodeUtil.createCodeWithLogoAndText(<span class="string">"http://www.pibigstar.com"</span>,<span class="string">"D:\\Document And Settings3\\Admin\\Desktop\\文本资料\\网站\\qq.png"</span>,<span class="string">"派大星博客"</span>);</span><br><span class="line">        ImageIO.write(bim, <span class="string">"png"</span>, <span class="keyword">new</span> File(<span class="string">"D:\\Document And Settings3\\Admin\\Desktop\\"</span> + <span class="keyword">new</span> Date().getTime() + <span class="string">".png"</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"done"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="生成效果"><a href="#生成效果" class="headerlink" title="生成效果"></a>生成效果</h1><h3 id="1-普通二维码"><a href="#1-普通二维码" class="headerlink" title="1. 普通二维码"></a>1. 普通二维码</h3><p><img src="https://img-blog.csdnimg.cn/20181129183213975.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt></p>
<h3 id="2-带logo的二维码"><a href="#2-带logo的二维码" class="headerlink" title="2. 带logo的二维码"></a>2. 带logo的二维码</h3><p><img src="https://img-blog.csdnimg.cn/20181129183228330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt></p>
<h3 id="3-带logo和文字的二维码"><a href="#3-带logo和文字的二维码" class="headerlink" title="3. 带logo和文字的二维码"></a>3. 带logo和文字的二维码</h3><p><img src="https://img-blog.csdnimg.cn/20181129183246138.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=,size_16,color_FFFFFF,t_70" alt></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/15/SpringBoot访问外部文件及默认路由/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/15/SpringBoot访问外部文件及默认路由/" itemprop="url">SpringBoot访问外部文件及默认路由</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-15T18:06:04+08:00">
                2019-06-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot-SpringBoot技能大全/" itemprop="url" rel="index">
                    <span itemprop="name">springboot,SpringBoot技能大全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-新增配置类"><a href="#1-新增配置类" class="headerlink" title="1 新增配置类"></a>1 新增配置类</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.pibigstar.common.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.pibigstar.common.Constant;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 访问外部文件配置，访问D盘下文件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//配置server虚拟路径，handler为jsp中访问的目录，locations为files相对应的本地路径     </span></span><br><span class="line">		registry.addResourceHandler(<span class="string">"/files/**"</span>).addResourceLocations(<span class="string">"file:///D:upload/"</span>);  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *	配置默认路由</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//将浏览器的默认行为重定向到主页</span></span><br><span class="line">        registry.addViewController(<span class="string">"/"</span>).setViewName(<span class="string">"redirect:/index.htm"</span>);</span><br><span class="line">        <span class="comment">//测试页面</span></span><br><span class="line">        registry.addViewController(<span class="string">"/test.htm"</span>).setViewName(<span class="string">"/test.jsp"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-访问"><a href="#2-访问" class="headerlink" title="2 访问"></a>2 访问</h1><p>我们将<code>test.jpg</code>文件上传到D盘的upload文件夹后，那么在页面端访问则通过：localhost:8080/files/test.jpg</p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/12/油猴插件编写学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/12/油猴插件编写学习/" itemprop="url">油猴插件编写学习</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-12T19:07:04+08:00">
                2019-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>油猴可以帮助我们在任意网页中镶嵌脚本来达到一些辅助我们的目的。</p>
<p>油猴官网：<a href="https://tampermonkey.net/" target="_blank" rel="noopener">https://tampermonkey.net/</a></p>
<h1 id="1-基本编写"><a href="#1-基本编写" class="headerlink" title="1. 基本编写"></a>1. 基本编写</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         脚本的名称</span></span><br><span class="line"><span class="comment">// @namespace    可以写个人的网站什么的</span></span><br><span class="line"><span class="comment">// @version      版本号</span></span><br><span class="line"><span class="comment">// @description  脚本的描述</span></span><br><span class="line"><span class="comment">// @author       作者</span></span><br><span class="line"><span class="comment">// @match        匹配站点，在那个网页中启用该脚本，可使用正则进行匹配</span></span><br><span class="line"><span class="comment">// @match        http://119.36.55.224:6850/zentao/my/</span></span><br><span class="line"><span class="comment">// @match        http://www.iqiyi.com/v_*</span></span><br><span class="line"><span class="comment">// @grant        需要什么权限（GM_addStyle添加css样式权限）</span></span><br><span class="line"><span class="comment">// @grant        GM_addStyle</span></span><br><span class="line"><span class="comment">// @require		 引用外部js</span></span><br><span class="line"><span class="comment">// @require		 http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//在这里编写我们的脚本</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h1 id="2-写一个百度自动搜索小脚本"><a href="#2-写一个百度自动搜索小脚本" class="headerlink" title="2. 写一个百度自动搜索小脚本"></a>2. 写一个百度自动搜索小脚本</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         自动输入</span></span><br><span class="line"><span class="comment">// @namespace    http://pibigstar.com/</span></span><br><span class="line"><span class="comment">// @version      0.1</span></span><br><span class="line"><span class="comment">// @description  百度框自动输入</span></span><br><span class="line"><span class="comment">// @author       派大星</span></span><br><span class="line"><span class="comment">// @match        https://www.baidu.com</span></span><br><span class="line"><span class="comment">// @require		 https://cdn.bootcss.com/jquery/2.2.1/jquery.js</span></span><br><span class="line"><span class="comment">// @grant        none</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">"#kw"</span>).val(<span class="string">"java派大星"</span>);</span><br><span class="line">    $(<span class="string">"#su"</span>).click();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h1 id="3-为百度新添加一个按钮"><a href="#3-为百度新添加一个按钮" class="headerlink" title="3. 为百度新添加一个按钮"></a>3. 为百度新添加一个按钮</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         自动输入</span></span><br><span class="line"><span class="comment">// @namespace    http://pibigstar.com/</span></span><br><span class="line"><span class="comment">// @version      0.1</span></span><br><span class="line"><span class="comment">// @description  百度框自动输入</span></span><br><span class="line"><span class="comment">// @author       派大星</span></span><br><span class="line"><span class="comment">// @match        https://www.baidu.com</span></span><br><span class="line"><span class="comment">// @match        http://www.cnblogs.com/*</span></span><br><span class="line"><span class="comment">// @require		 https://cdn.bootcss.com/jquery/2.2.1/jquery.js</span></span><br><span class="line"><span class="comment">// @grant        GM_addStyle</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//与元数据块中的@grant值相对应，功能是生成一个style样式</span></span><br><span class="line">    GM_addStyle(<span class="string">'#myBtn&#123;color: white;position: absolute;left: 1100px;top: 243px;width: 100px;height: 36px;background: #3385ff;border-bottom: 1px solid #2d7'</span>);</span><br><span class="line">    <span class="keyword">var</span> html = <span class="string">"&lt;input type='button' id='myBtn' value='新增按钮' /&gt;"</span>;</span><br><span class="line">    $(<span class="string">"body"</span>).append(html);</span><br><span class="line">    <span class="comment">// 定义按钮事件</span></span><br><span class="line">    $(<span class="string">"#myBtn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      alert(<span class="string">"点击了新增按钮"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h1 id="4-综合，写一个VIP视频解析脚本"><a href="#4-综合，写一个VIP视频解析脚本" class="headerlink" title="4. 综合，写一个VIP视频解析脚本"></a>4. 综合，写一个VIP视频解析脚本</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         视频vip解析</span></span><br><span class="line"><span class="comment">// @namespace    http://mxspvip.cn</span></span><br><span class="line"><span class="comment">// @version      1.2</span></span><br><span class="line"><span class="comment">// @description  支持，优酷、爱奇艺、腾讯、乐视等vip视频播放</span></span><br><span class="line"><span class="comment">// @author       pibigstar</span></span><br><span class="line"><span class="comment">// @match        http://www.iqiyi.com/v_*</span></span><br><span class="line"><span class="comment">// @match        http://www.mgtv.com/v/*</span></span><br><span class="line"><span class="comment">// @match        http://www.le.com/ptv/*</span></span><br><span class="line"><span class="comment">// @match        http://v.youku.com/v_show/*</span></span><br><span class="line"><span class="comment">// @match        http://film.sohu.com/album/*</span></span><br><span class="line"><span class="comment">// @match        http://tv.sohu.com/*</span></span><br><span class="line"><span class="comment">// @match        https://v.qq.com/x/cover/*</span></span><br><span class="line"><span class="comment">// @grant        GM_addStyle</span></span><br><span class="line"><span class="comment">// @require      https://cdn.bootcss.com/jquery/2.2.1/jquery.js</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs&#123;width:170px;background:#fff;position:fixed;top:180px;right:0;z-index:999;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs a&#123;color:#666;text-decoration:none;outline:none;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs a:hover&#123;color:#e8431f;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs .floatDtt&#123;width:100%;height:50px;line-height:50px; background:#f08326;color:#fff;font-size:20px;text-indent:22px;position:relative;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs .floatDqq&#123;padding:0 14px;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs .floatDqq li&#123;height:45px;line-height:45px;font-size:15px;border-bottom:1px solid #e3e3e3;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#floatDivBoxs .floatDbg&#123;width:100%;height:20px;box-shadow:-2px 0 3px rgba(0,0,0,0.25);&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'.floatShadow&#123;box-shadow:-2px 0 3px rgba(0,0,0,0.25);&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#rightArrow&#123;width:50px;height:45px;position:fixed;top:180px;right:170px;z-index:999;&#125;'</span>)</span><br><span class="line">GM_addStyle(<span class="string">'#rightArrow a&#123;background:#F08326;display:block;height:50px;&#125;'</span>)</span><br><span class="line">    GM_addStyle(<span class="string">'#rightArrow a img&#123;background:#F08326;display:block;height:50px;width:45px;&#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> html = <span class="string">'&lt;div id="rightArrow"&gt;&lt;a href="javascript:;" title=""&gt;&lt;img id="rightImg" src="http://pmyln8jkg.bkt.clouddn.com/youhou/right.png" /&gt;&lt;/a&gt;&lt;/div&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;div id="floatDivBoxs"&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;div class="floatDtt"&gt;vip通道&lt;/div&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;div class="floatShadow"&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;ul class="floatDqq"&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://www.wmxz.wang/video.php?url="&gt; 无名小站&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="https://cn.bjbanshan.cn/jiexi.php?url="&gt;1号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="https://aikan-tv.com/tong.php?url="&gt;2号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://api.51ckm.com/jx.php?url="&gt;3号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://api.nepian.com/ckparse/?url="&gt;4号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://jqaaa.com/jq3/?url="&gt;5号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://2gty.com/apiurl/yun.php?url="&gt;6号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://http://aikan-tv.com/?url="&gt;7号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">       html += <span class="string">'&lt;li&gt;&lt;a href="#" name="vip" url="http://y.mt2t.com/lines?url="&gt;8号接口&lt;/a&gt;&lt;/li&gt;'</span></span><br><span class="line">   html += <span class="string">' &lt;/ul&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">  html += <span class="string">'&lt;/div&gt;'</span></span><br><span class="line"><span class="comment">// 添加到页面上</span></span><br><span class="line">$(<span class="string">"body"</span>).append(html);</span><br><span class="line"><span class="comment">//浮动代码</span></span><br><span class="line"><span class="keyword">var</span> flag=<span class="number">1</span>;</span><br><span class="line">$(<span class="string">'#rightArrow'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(flag==<span class="number">1</span>)&#123;</span><br><span class="line">		$(<span class="string">"#floatDivBoxs"</span>).animate(&#123;<span class="attr">right</span>: <span class="string">'-175px'</span>&#125;,<span class="number">300</span>);</span><br><span class="line">		$(<span class="keyword">this</span>).animate(&#123;<span class="attr">right</span>: <span class="string">'-5px'</span>&#125;,<span class="number">300</span>);</span><br><span class="line">		$(<span class="keyword">this</span>).css(<span class="string">'background-position'</span>,<span class="string">'-50px 0'</span>);</span><br><span class="line">        $(<span class="string">"#rightImg"</span>).attr(<span class="string">"src"</span>,<span class="string">"http://pmyln8jkg.bkt.clouddn.com/youhou/left.png"</span>);</span><br><span class="line">		flag=<span class="number">0</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		$(<span class="string">"#floatDivBoxs"</span>).animate(&#123;<span class="attr">right</span>: <span class="string">'0'</span>&#125;,<span class="number">300</span>);</span><br><span class="line">		$(<span class="keyword">this</span>).animate(&#123;<span class="attr">right</span>: <span class="string">'170px'</span>&#125;,<span class="number">300</span>);</span><br><span class="line">		$(<span class="keyword">this</span>).css(<span class="string">'background-position'</span>,<span class="string">'0px 0'</span>);</span><br><span class="line">        $(<span class="string">"#rightImg"</span>).attr(<span class="string">"src"</span>,<span class="string">"http://pmyln8jkg.bkt.clouddn.com/youhou/right.png"</span>);</span><br><span class="line">		flag=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// 监听每一个接口点击事件</span></span><br><span class="line">$(<span class="string">"a[name='vip']"</span>).on(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//获取当前网址</span></span><br><span class="line">    <span class="keyword">var</span> url = <span class="built_in">window</span>.location;</span><br><span class="line">    <span class="keyword">var</span> api = $(<span class="keyword">this</span>).attr(<span class="string">"url"</span>);</span><br><span class="line">    <span class="built_in">window</span>.open(api+url,<span class="string">''</span>,<span class="string">'width=632,height=388,toolbar=no,location=no,status=no, menubar=no, resizable=yes, scrollbars=yes'</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/10/注解防止表单重复提交/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/10/注解防止表单重复提交/" itemprop="url">注解防止表单重复提交</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-10T20:08:04+08:00">
                2019-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java-SpringBoot技能大全/" itemprop="url" rel="index">
                    <span itemprop="name">Java,SpringBoot技能大全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-注解"><a href="#1-注解" class="headerlink" title="1. 注解"></a>1. 注解</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> StopRepeatSubmit &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-拦截处理器"><a href="#2-拦截处理器" class="headerlink" title="2. 拦截处理器"></a>2. 拦截处理器</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> pibigstar</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 防止表单重复提交拦截处理器</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopRepeatSubmitHandlerInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (handler <span class="keyword">instanceof</span> HandlerMethod) &#123;</span><br><span class="line">            HandlerMethod handlerMethod = (HandlerMethod) handler;</span><br><span class="line">            Method method = handlerMethod.getMethod();</span><br><span class="line">            StopRepeatSubmit annotation = method.getAnnotation(StopRepeatSubmit.class);</span><br><span class="line">            <span class="keyword">if</span> (annotation!=<span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 判断是否已经提交过了</span></span><br><span class="line">                String paramter = request.getParameterMap().toString();</span><br><span class="line">                String url = request.getRequestURL().toString();</span><br><span class="line">                String token = url+paramter;</span><br><span class="line">                Object attrToken = request.getSession().getAttribute(<span class="string">"token"</span>);</span><br><span class="line">                <span class="keyword">if</span> (attrToken == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// 第一次请求</span></span><br><span class="line">                    request.getSession().setAttribute(<span class="string">"token"</span>,token);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (attrToken.toString().equals(token))&#123;</span><br><span class="line">                    <span class="comment">// 重复提交了</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 第一次提交</span></span><br><span class="line">                    request.getSession().setAttribute(<span class="string">"token"</span>,token);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.preHandle(request, response, handler);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/submit"</span>)</span><br><span class="line"><span class="meta">@StopRepeatSubmit</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">submit</span><span class="params">()</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/10/git常用操作详细说明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/10/git常用操作详细说明/" itemprop="url">git常用操作详细说明</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-10T20:08:04+08:00">
                2019-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具使用-git/" itemprop="url" rel="index">
                    <span itemprop="name">工具使用,git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>初级的就不说了，下面记录一些常用且稍微高级点的操作<br>@[TOC]</p>
<h2 id="git的管理流程"><a href="#git的管理流程" class="headerlink" title="git的管理流程"></a>git的管理流程</h2><p><strong>工作区 ——&gt; git add ——&gt; Index[索引][暂存区] ——&gt; git commit ——&gt; HEAD[快照]</strong></p>
<blockquote>
<p>当执行<code>git add</code> 后其实就是将更改的文件放入到暂存区中，当执行<code>git commit</code>时就是将暂存区的内容提交到当前分支</p>
</blockquote>
<ul>
<li>HEAD快照是保存你最后一次commit的内容</li>
<li>git push 是将快照区的内容push 上去</li>
</ul>
<h2 id="git常用操作"><a href="#git常用操作" class="headerlink" title="git常用操作"></a>git常用操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 图形化显示log日志</span></span><br><span class="line">gitk  --all</span><br><span class="line"><span class="comment"># 简洁的log 日志</span></span><br><span class="line">git <span class="built_in">log</span> --oneline </span><br><span class="line"><span class="comment"># 查看所有分支</span></span><br><span class="line">git <span class="built_in">log</span> --all </span><br><span class="line"><span class="comment"># 显示最近4个提交</span></span><br><span class="line">git <span class="built_in">log</span> -n4 </span><br><span class="line"><span class="comment">#  显示变更信息</span></span><br><span class="line">git <span class="built_in">log</span> --graph</span><br><span class="line"><span class="comment"># 查看暂存区与HEAD中的差别</span></span><br><span class="line">git diff --cached </span><br><span class="line"><span class="comment"># 配置git log</span></span><br><span class="line">git config --global alias.lg <span class="string">"log --graph --pretty=format:'%Cred%h%Creset - %C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit --date=relative"</span></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">git lg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看提交了多少行代码</span></span><br><span class="line">git <span class="built_in">log</span> --author=<span class="string">"<span class="variable">$(git config --get user.name)</span>"</span> --pretty=tformat: --numstat | gawk <span class="string">'&#123; add += $1 ; subs += $2 ; loc += $1 - $2 &#125; END &#123; printf "added lines: %s removed lines : %s total lines: %s\n",add,subs,loc &#125;'</span> -</span><br></pre></td></tr></table></figure>

<h2 id="1-关联"><a href="#1-关联" class="headerlink" title="1. 关联"></a>1. 关联</h2><ul>
<li><h3 id="1-1-关联仓库"><a href="#1-1-关联仓库" class="headerlink" title="1.1 关联仓库"></a>1.1 关联仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin 仓库地址</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>你可以同时关联其他的仓库（也包括gitee和gitlab）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin-2 仓库地址</span><br></pre></td></tr></table></figure>

<p>这样你push的时候</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin-2 master</span><br></pre></td></tr></table></figure>

<h2 id="2-分支"><a href="#2-分支" class="headerlink" title="2. 分支"></a>2. 分支</h2><h4 id="2-1-只创建一个分支"><a href="#2-1-只创建一个分支" class="headerlink" title="2.1 只创建一个分支"></a>2.1 只创建一个分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch fix-1</span><br></pre></td></tr></table></figure>

<h4 id="2-2-创建分支并切换此分支"><a href="#2-2-创建分支并切换此分支" class="headerlink" title="2.2 创建分支并切换此分支"></a>2.2 创建分支并切换此分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b feat-1</span><br></pre></td></tr></table></figure>

<h4 id="2-3-切换分支"><a href="#2-3-切换分支" class="headerlink" title="2.3 切换分支"></a>2.3 切换分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br></pre></td></tr></table></figure>

<h4 id="2-4-查看所有分支"><a href="#2-4-查看所有分支" class="headerlink" title="2.4 查看所有分支"></a>2.4 查看所有分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -v</span><br></pre></td></tr></table></figure>

<h4 id="2-5-删除分支"><a href="#2-5-删除分支" class="headerlink" title="2.5 删除分支"></a>2.5 删除分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d feat-1</span><br></pre></td></tr></table></figure>

<h4 id="2-6-删除除master以外的所有分支"><a href="#2-6-删除除master以外的所有分支" class="headerlink" title="2.6 删除除master以外的所有分支"></a>2.6 删除除master以外的所有分支</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch | grep -v <span class="string">"master"</span> | xargs git branch -D</span><br></pre></td></tr></table></figure>

<h2 id="3-临时暂存区"><a href="#3-临时暂存区" class="headerlink" title="3. 临时暂存区"></a>3. 临时暂存区</h2><h4 id="3-1-将更改放到临时暂存区"><a href="#3-1-将更改放到临时暂存区" class="headerlink" title="3.1 将更改放到临时暂存区"></a>3.1 将更改放到临时暂存区</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br></pre></td></tr></table></figure>

<h4 id="3-2-将更改从临时暂存区取出"><a href="#3-2-将更改从临时暂存区取出" class="headerlink" title="3.2 将更改从临时暂存区取出"></a>3.2 将更改从临时暂存区取出</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash pop</span><br></pre></td></tr></table></figure>

<h4 id="3-3-查看临时暂存区内容"><a href="#3-3-查看临时暂存区内容" class="headerlink" title="3.3 查看临时暂存区内容"></a>3.3 查看临时暂存区内容</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash list</span><br></pre></td></tr></table></figure>

<h4 id="3-4-恢复指定临时暂存区"><a href="#3-4-恢复指定临时暂存区" class="headerlink" title="3.4 恢复指定临时暂存区"></a>3.4 恢复指定临时暂存区</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash apply stash@&#123;id&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-合并冲突"><a href="#4-合并冲突" class="headerlink" title="4. 合并冲突"></a>4. 合并冲突</h2><p>1.更新代码 <code>git fetch</code><br>2.合并分支 <code>git rebase origin/develop</code> //将develop分支与此分支合并<br>3.会进入合并分支，当有<strong>CONFLICT:Merge file.txt</strong>, 手动去修改此文件<br>4.修改之后添加冲突文件 <code>git add file.txt</code><br>5.继续合并 <code>git rebase --continue</code>, 如果有错误继续 执行 3 4 步骤<br>6.当分支名变成你的分支名则表示合并完成<br>7.查看当前状态 git status<br>8.如果状态都为已暂存，则可以执行 <code>git push origin 分支名</code> 进行提交</p>
<h4 id="push之前忘记git-pull"><a href="#push之前忘记git-pull" class="headerlink" title="push之前忘记git pull"></a>push之前忘记git pull</h4><p>出现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">! [rejected]  master -&gt; master (fetch first)</span><br></pre></td></tr></table></figure>

<p>可以使用下面这个命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull --rebase origin master</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个命令是先取消commit记录，并且把它们临时 保存为补丁(patch)(这些补丁放到”.git/rebase”目录中)，之后同步远程库到本地，最后合并补丁到本地库之中。 </p>
</blockquote>
<p>然后再直接进行push就可以了</p>
<h2 id="5-回滚"><a href="#5-回滚" class="headerlink" title="5. 回滚"></a>5. 回滚</h2><h4 id="5-1-撤销掉本地修改（还没被git-add）"><a href="#5-1-撤销掉本地修改（还没被git-add）" class="headerlink" title="5.1 撤销掉本地修改（还没被git add）"></a>5.1 撤销掉本地修改（还没被git add）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 撤销某具体文件</span></span><br><span class="line">git checkout fileName</span><br><span class="line"><span class="comment"># 撤销所有</span></span><br><span class="line">git checkout .</span><br></pre></td></tr></table></figure>

<h4 id="5-2-撤销上一次git-add的内容"><a href="#5-2-撤销上一次git-add的内容" class="headerlink" title="5.2 撤销上一次git add的内容"></a>5.2 撤销上一次<code>git add</code>的内容</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 撤销某个文件</span></span><br><span class="line">git reset HEAD fileName</span><br><span class="line"><span class="comment"># 撤销所有</span></span><br><span class="line">git reset HEAD .</span><br></pre></td></tr></table></figure>

<p>只撤销某个文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD 文件路径/文件名</span><br></pre></td></tr></table></figure>

<h4 id="5-3-撤销上一次git-commit"><a href="#5-3-撤销上一次git-commit" class="headerlink" title="5.3 撤销上一次git commit"></a>5.3 撤销上一次<code>git commit</code></h4><ol>
<li><p>先查看日志，记录commit id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>恢复到指定commit</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reset commit_id</span><br><span class="line"><span class="comment"># 备用</span></span><br><span class="line">git reset --hard  commit_id</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="5-4-修改上一次commit"><a href="#5-4-修改上一次commit" class="headerlink" title="5.4 修改上一次commit"></a>5.4 修改上一次commit</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure>

<h4 id="5-5-撤销git-commit-和-git-add-以及-工作区更新的内容"><a href="#5-5-撤销git-commit-和-git-add-以及-工作区更新的内容" class="headerlink" title="5.5 撤销git commit 和 git add 以及 工作区更新的内容"></a>5.5 撤销git commit 和 git add 以及 工作区更新的内容</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD~</span><br></pre></td></tr></table></figure>

<h4 id="5-5-删除远程分支中某个文件"><a href="#5-5-删除远程分支中某个文件" class="headerlink" title="5.5 删除远程分支中某个文件"></a>5.5 删除远程分支中某个文件</h4><p>这个只是让此文件不受版本控制了，而本地是不会删除它的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git rm -r –-cached 文件路径/文件名</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"delete the file"</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<h4 id="5-6-回滚到指定版本"><a href="#5-6-回滚到指定版本" class="headerlink" title="5.6 回滚到指定版本"></a>5.6 回滚到指定版本</h4><ol>
<li><p>查看日志拿到commitid</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>恢复到指定版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard commit_id</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="6-开源协作"><a href="#6-开源协作" class="headerlink" title="6.开源协作"></a>6.开源协作</h2><h4 id="6-1-fork别人代码"><a href="#6-1-fork别人代码" class="headerlink" title="6.1 fork别人代码"></a>6.1 fork别人代码</h4><p>此时你的仓库就会有一个此项目的副本</p>
<h4 id="6-2-克隆代码"><a href="#6-2-克隆代码" class="headerlink" title="6.2 克隆代码"></a>6.2 克隆代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> *****.git</span><br></pre></td></tr></table></figure>

<h4 id="6-3-添加别人远程仓库地址"><a href="#6-3-添加别人远程仓库地址" class="headerlink" title="6.3 添加别人远程仓库地址"></a>6.3 添加别人远程仓库地址</h4><p>为了可以随时更新代码，这里最好将别人仓库的地址也新增一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin2 *****.git</span><br></pre></td></tr></table></figure>

<p>拉取别人最新代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin2 master</span><br></pre></td></tr></table></figure>

<h4 id="6-4-提交"><a href="#6-4-提交" class="headerlink" title="6.4 提交"></a>6.4 提交</h4><p>添加新的功能之后开始提交代码，代码是提交到你的仓库中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<h4 id="6-5-提交PR"><a href="#6-5-提交PR" class="headerlink" title="6.5 提交PR"></a>6.5 提交PR</h4><p>去你GitHub中此项目然后会有一个New pull Request</p>
<p><img src="https://img-blog.csdnimg.cn/20190405172555465.png" alt><br>点击它，然后向别人的项目提交PR</p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/08/SpringBoot操作elasticsearch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/08/SpringBoot操作elasticsearch/" itemprop="url">SpringBoot操作elasticsearch</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-08T22:10:04+08:00">
                2019-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/springboot-SpringBoot技能大全/" itemprop="url" rel="index">
                    <span itemprop="name">springboot,SpringBoot技能大全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>注意：</strong> elasticsearch版本一定要和SpringBoot版本相对应。</p>
<p>这里使用的是：elasticsearch : 6.5.3,  Springboot: 2.1.0</p>
<p>下载Elasticsearch:<a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.5.3.zip" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.5.3.zip</a></p>
<p>监控Elasticsearch中的值：<a href="https://artifacts.elastic.co/downloads/kibana/kibana-6.5.3-windows-x86_64.zip" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/kibana/kibana-6.5.3-windows-x86_64.zip</a></p>
<ol>
<li><p>启动elasticsearch</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch-6.5.3/bin/ealsticsearch.batelasticsearch-6.5.3/bin/ealsticsearch.bat</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动监控</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kibana-6.5.3-windows-x86_64/bin/kibana.bat</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>启动成功后访问：127.0.0.1:5601</p>
<h1 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="2-添加配置信息"><a href="#2-添加配置信息" class="headerlink" title="2. 添加配置信息"></a>2. 添加配置信息</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  data:</span></span><br><span class="line"><span class="attr">   elasticsearch:</span></span><br><span class="line"><span class="attr">    cluster-nodes:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:9300</span></span><br><span class="line"><span class="attr">    cluster-name:</span> <span class="string">elasticsearch</span></span><br></pre></td></tr></table></figure>

<h1 id="3-标记bean"><a href="#3-标记bean" class="headerlink" title="3. 标记bean"></a>3. 标记bean</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index索引就相当于数据库，type就相当于表</span></span><br><span class="line"><span class="meta">@Document</span>(indexName = <span class="string">"pibigstar"</span>,type = <span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElasticUser</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">//setter,getter方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-dao层"><a href="#4-dao层" class="headerlink" title="4. dao层"></a>4. dao层</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.pibgstar.demo.elastic.bean.ElasticUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ElasticUserDao</span> <span class="keyword">extends</span> <span class="title">ElasticsearchRepository</span>&lt;<span class="title">ElasticUser</span>,<span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-Controller层"><a href="#5-Controller层" class="headerlink" title="5. Controller层"></a>5. Controller层</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElasticUserController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> sum = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ElasticUserDao userDao;</span><br><span class="line">    <span class="comment">// 获取全部</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/list"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ElasticUser&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Iterable&lt;ElasticUser&gt; all = userDao.findAll();</span><br><span class="line">        Iterator&lt;ElasticUser&gt; iterator = all.iterator();</span><br><span class="line">        List&lt;ElasticUser&gt; list=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            list.add(iterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 添加</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/add"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ElasticUser <span class="title">add</span><span class="params">(ElasticUser user)</span> </span>&#123;</span><br><span class="line">        user.setId(sum++);</span><br><span class="line">        ElasticUser save = userDao.save(user);</span><br><span class="line">        <span class="keyword">return</span> save;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据id获取</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/get"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ElasticUser <span class="title">get</span><span class="params">(Long id)</span></span>&#123;</span><br><span class="line">        Optional&lt;ElasticUser&gt; byId = userDao.findById(id);</span><br><span class="line">        <span class="keyword">return</span> byId.get();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/delete"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(ElasticUser user)</span></span>&#123;</span><br><span class="line">        userDao.delete(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 更新</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ElasticUser <span class="title">update</span><span class="params">(ElasticUser user)</span> </span>&#123;</span><br><span class="line">        ElasticUser save = userDao.save(user);</span><br><span class="line">        <span class="keyword">return</span> save;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 搜索</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;ElasticUser&gt; <span class="title">query</span><span class="params">(@RequestParam(name = <span class="string">"value"</span>)</span> String value)</span>&#123;</span><br><span class="line">        <span class="comment">// 当id、username、password字段的值等于value时可查出数据（里面的值要有value，不然会报错）</span></span><br><span class="line">        <span class="comment">// QueryStringQueryBuilder builder = new QueryStringQueryBuilder(value);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 搜索 id、username字段的值等于value</span></span><br><span class="line">        <span class="comment">// QueryBuilder builder = QueryBuilders.multiMatchQuery(value,"id","username");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 模糊查询，username字段中的值含有value</span></span><br><span class="line">        QueryBuilder builder1 = QueryBuilders.wildcardQuery(<span class="string">"username"</span>,<span class="string">"*"</span>+value+<span class="string">"*"</span>);</span><br><span class="line">        <span class="comment">// password字段等于1</span></span><br><span class="line">        QueryBuilder builder2 = QueryBuilders.wildcardQuery(<span class="string">"password"</span>,<span class="string">"*456*"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 复合查询</span></span><br><span class="line">        BoolQueryBuilder boolQueryBuilder = QueryBuilders.boolQuery();</span><br><span class="line">        <span class="comment">// and 结果中 username含有value 并且 password = 456</span></span><br><span class="line">        <span class="comment">// boolQueryBuilder.must(builder1);</span></span><br><span class="line">        <span class="comment">// boolQueryBuilder.must(builder2);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// or 结果中 username含有value 或 password = 456</span></span><br><span class="line">        boolQueryBuilder.should(builder1);</span><br><span class="line">        boolQueryBuilder.should(builder2);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"查询的语句:"</span>+boolQueryBuilder);</span><br><span class="line">        Iterable&lt;ElasticUser&gt; searchResult = userDao.search(boolQueryBuilder);</span><br><span class="line">        Iterator&lt;ElasticUser&gt; iterator = searchResult.iterator();</span><br><span class="line">        List&lt;ElasticUser&gt; list=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            list.add(iterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pibigstar.com/2019/06/07/Go语言入门（1）Go语言的安装与配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="派大星">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="派大星的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/07/Go语言入门（1）Go语言的安装与配置/" itemprop="url">Go语言入门（1）Go语言的安装与配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-07T23:11:04+08:00">
                2019-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/go/" itemprop="url" rel="index">
                    <span itemprop="name">go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-下载Go语言"><a href="#1-下载Go语言" class="headerlink" title="1. 下载Go语言"></a>1. 下载Go语言</h1><p>GO安装包下载地址： <a href="https://studygolang.com/dl" target="_blank" rel="noopener">https://studygolang.com/dl</a></p>
<h1 id="2-Windows下安装GO"><a href="#2-Windows下安装GO" class="headerlink" title="2. Windows下安装GO"></a>2. Windows下安装GO</h1><p>下载好之后，直接安装，下一步。。。。finsh</p>
<p>测试是否安装成功：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version</span><br></pre></td></tr></table></figure>

<h1 id="3-配置GOPATH"><a href="#3-配置GOPATH" class="headerlink" title="3. 配置GOPATH"></a>3. 配置GOPATH</h1><p>新建环境变量 GOPATH = D:/goWork</p>
<p>GOPATH是你的工作目录，它包括三个目录：bin（存放编译好的可运行文件）、pkg（存放二进制文件）、src（存放源码文件）</p>
<p>当通过 go get github.com/astaxie/beego 下载的库都会放到这个GOPATH里面</p>
<h1 id="4-下载开发工具"><a href="#4-下载开发工具" class="headerlink" title="4. 下载开发工具"></a>4. 下载开发工具</h1><p>这里使用的开发工具为 goland</p>
<p>下载地址：<a href="https://www.jetbrains.com/go/" target="_blank" rel="noopener">https://www.jetbrains.com/go/</a></p>
<h1 id="5-配置goland"><a href="#5-配置goland" class="headerlink" title="5. 配置goland"></a>5. 配置goland</h1><p>主要配置 GOROOT 和 GOPATH</p>
<p><img src="https://img-blog.csdn.net/2018080420560173?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2p1bm1veGk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt></p>

          
        
      
    </div>
    
    
    

    <div>
      
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/qq.png" alt="派大星">
            
              <p class="site-author-name" itemprop="name">派大星</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">137</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">64</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">230</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pibigstar" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/junmoxi" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-yelp"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-[object Object]"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">派大星</span>

  
</div>







        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
<!-- 页面点击小红心 -->
 <script type="text/javascript" src="/js/src/clicklove.js"></script>
 <!-- 代码复制 -->
 <script type="text/javascript" src="/js/src/clipboard.js"></script> 
